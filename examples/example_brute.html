
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Global minimization using the brute method (a.k.a. grid search) &#8212; Non-Linear Least-Squares Minimization and Curve-Fitting for Python</title>
    <link rel="stylesheet" href="../_static/lmfitdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="doc_model_savemodel.py" href="documentation/model_savemodel.html" />
    <link rel="prev" title="Model Selection using lmfit and emcee" href="lmfit_emcee_model_selection.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
        "HTML-CSS": {scale: 90}
  });</script>

  </head><body>
<div>
<table border=0>
  <tr><td></td><td width=80% padding=5 align=left>
          <a href="../contents.html/../index.html" style="color: #157"> <font size=+3>LMFIT</font></a>
     </td>
     <td width=6% align=left>
         <a href="../contents.html" style="color: #882222">
         <font size+=1>Contents</font></a> </td>
     <td width=6% align=left>
          <a href="index.html" style="color: #882222">
          <font size+=1>Examples</font></a></td>
     <td width=6% align=left>
          <a href="../installation.html" style="color: #882222">
          <font size+=1>Download</font></a></td>
     <td></td>
  </tr>
  <tr><td></td><td width=80% padding=5 align=left>
        <a href="../contents.html/../index.html" style="color: #157"> <font size=+2>
	Non-Linear Least-Squares Minimization and Curve-Fitting for Python</font></a>
     </td>
     <td width=6% align=left>
         <a href="../faq.html" style="color: #882222">
         <font size+=1>FAQ</font></a> </td>
     <td width=6% align=left>
         <a href="../support.html" style="color: #882222">
         <font size+=1>Support</font></a> </td>
     <td width=6% align=left>
        <a href="https://github.com/lmfit/lmfit-py/" style="color: #882222">
         <font size+=1>Develop</font></a></td>
     <td></td>
  </tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="documentation/model_savemodel.html" title="doc_model_savemodel.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lmfit_emcee_model_selection.html" title="Model Selection using lmfit and emcee"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../intro.html">intro</a>|</li>
   <li><a href="../parameters.html">parameters</a>|</li>
   <li><a href="../fitting.html"> minimize</a>|</li>
   <li><a href="../model.html"> model</a>|</li>
   <li><a href="../builtin_models.html"> built-in models</a>|</li>
   <li><a href="../confidence.html">confidence intervals</a>|</li>
   <li><a href="../bounds.html">bounds</a>|</li>
   <li><a href="../constraints.html">constraints</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Examples gallery</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="lmfit_emcee_model_selection.html"
                        title="previous chapter">Model Selection using lmfit and emcee</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="documentation/model_savemodel.html"
                        title="next chapter">doc_model_savemodel.py</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/example_brute.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-example-brute-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="global-minimization-using-the-brute-method-a-k-a-grid-search">
<span id="sphx-glr-examples-example-brute-py"></span><h1>Global minimization using the <code class="docutils literal notranslate"><span class="pre">brute</span></code> method (a.k.a. grid search)<a class="headerlink" href="#global-minimization-using-the-brute-method-a-k-a-grid-search" title="Permalink to this headline">¶</a></h1>
<p>This notebook shows a simple example of using <code class="docutils literal notranslate"><span class="pre">lmfit.minimize.brute</span></code> that
uses the method with the same name from <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.</p>
<p>The method computes the function’s value at each point of a multidimensional
grid of points, to find the global minimum of the function. It behaves
identically to <code class="docutils literal notranslate"><span class="pre">scipy.optimize.brute</span></code> in case finite bounds are given on
all varying parameters, but will also deal with non-bounded parameters
(see below).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span> <span class="n">Minimizer</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">fit_report</span>
</pre></div>
</div>
<p>Let’s start with the example given in the documentation of SciPy:</p>
<p>“We illustrate the use of brute to seek the global minimum of a function of
two variables that is given as the sum of a positive-definite quadratic and
two deep “Gaussian-shaped” craters. Specifically, define the objective
function f as the sum of three other functions, <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">f1</span> <span class="pre">+</span> <span class="pre">f2</span> <span class="pre">+</span> <span class="pre">f3</span></code>. We
suppose each of these has a signature <code class="docutils literal notranslate"><span class="pre">(z,</span> <span class="pre">*params),</span> <span class="pre">where</span> <span class="pre">z</span> <span class="pre">=</span> <span class="pre">(x,</span> <span class="pre">y)</span></code>,
and params and the functions are as defined below.”</p>
<p>First, we create a set of Parameters where all variables except <code class="docutils literal notranslate"><span class="pre">x</span></code> and
<code class="docutils literal notranslate"><span class="pre">y</span></code> are given fixed values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_many</span><span class="p">(</span>
        <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>Second, create the three functions and the objective function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">par</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">+</span>
            <span class="n">par</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">par</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]))</span>


<span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">par</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]))</span>


<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f1</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f2</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">f3</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>Just as in the documentation we will do a grid search between <code class="docutils literal notranslate"><span class="pre">-4</span></code> and
<code class="docutils literal notranslate"><span class="pre">4</span></code> and use a stepsize of <code class="docutils literal notranslate"><span class="pre">0.25</span></code>. The bounds can be set as usual with
the <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> attributes, and the stepsize is set using
<code class="docutils literal notranslate"><span class="pre">brute_step</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">brute_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">brute_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
<p>Performing the actual grid search is done with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;brute&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>, which will increment <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> between <code class="docutils literal notranslate"><span class="pre">-4</span></code> in increments of
<code class="docutils literal notranslate"><span class="pre">0.25</span></code> until <code class="docutils literal notranslate"><span class="pre">4</span></code> (not inclusive).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_x</span><span class="p">,</span> <span class="n">grid_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_x</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-4.   -3.75 -3.5  -3.25 -3.   -2.75 -2.5  -2.25 -2.   -1.75 -1.5  -1.25
 -1.   -0.75 -0.5  -0.25  0.    0.25  0.5   0.75  1.    1.25  1.5   1.75
  2.    2.25  2.5   2.75  3.    3.25  3.5   3.75]
</pre></div>
</div>
<p>The objective function is evaluated on this grid, and the raw output from
<code class="docutils literal notranslate"><span class="pre">scipy.optimize.brute</span></code> is stored in the MinimizerResult as
<code class="docutils literal notranslate"><span class="pre">brute_&lt;parname&gt;</span></code> attributes. These attributes are:</p>
<p><code class="docutils literal notranslate"><span class="pre">result.brute_x0</span></code> – A 1-D array containing the coordinates of a point at
which the objective function had its minimum value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_x0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-1.    1.75]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result.brute_fval</span></code> – Function value at the point x0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_fval</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>-2.8923637137222027
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result.brute_grid</span></code> – Representation of the evaluation grid. It has the
same length as x0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[[-4.   -4.   -4.   ... -4.   -4.   -4.  ]
  [-3.75 -3.75 -3.75 ... -3.75 -3.75 -3.75]
  [-3.5  -3.5  -3.5  ... -3.5  -3.5  -3.5 ]
  ...
  [ 3.25  3.25  3.25 ...  3.25  3.25  3.25]
  [ 3.5   3.5   3.5  ...  3.5   3.5   3.5 ]
  [ 3.75  3.75  3.75 ...  3.75  3.75  3.75]]

 [[-4.   -3.75 -3.5  ...  3.25  3.5   3.75]
  [-4.   -3.75 -3.5  ...  3.25  3.5   3.75]
  [-4.   -3.75 -3.5  ...  3.25  3.5   3.75]
  ...
  [-4.   -3.75 -3.5  ...  3.25  3.5   3.75]
  [-4.   -3.75 -3.5  ...  3.25  3.5   3.75]
  [-4.   -3.75 -3.5  ...  3.25  3.5   3.75]]]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result.brute_Jout</span></code> – Function values at each point of the evaluation
grid, i.e., Jout = func(*grid).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[134.         119.6875     106.25       ...  74.18749997  85.24999999
   97.1875    ]
 [129.125      115.         101.75       ...  74.74999948  85.99999987
   98.12499997]
 [124.5        110.5625      97.5        ...  75.5624928   86.99999818
   99.31249964]
 ...
 [ 94.12499965  85.24999772  77.24998843 ... 192.         208.5
  225.875     ]
 [ 96.49999997  87.81249979  79.99999892 ... 199.8125     216.5
  234.0625    ]
 [ 99.125       90.62499998  82.99999992 ... 207.875      224.75
  242.5       ]]
</pre></div>
</div>
<p><strong>Reassuringly, the obtained results are indentical to using the method in
SciPy directly!</strong></p>
<p>Example 2: fit of a decaying sine wave</p>
<p>In this example, will explain some of the options ot the algorithm.</p>
<p>We start off by generating some synthetic data with noise for a decaying
sine wave, define an objective function and create a Parameter set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="mf">0.025</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">fcn2min</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model decaying sine wave, subtract data.&quot;&quot;&quot;</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">]</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;omega&#39;</span><span class="p">]</span>
    <span class="n">decay</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;decay&#39;</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">decay</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span> <span class="o">-</span> <span class="n">data</span>


<span class="c1"># create a set of Parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;decay&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_example_brute_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_example_brute_001.png" />
<p>In contrast to the implementation in SciPy (as shown in the first example),
varying parameters do not need to have finite bounds in lmfit. However, in
that case they <strong>do</strong> need the <code class="docutils literal notranslate"><span class="pre">brute_step</span></code> attribute specified, so let’s
do that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">brute_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;decay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">brute_step</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">brute_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
<p>Our initial parameter set is now defined as shown below and this will
determine how the grid is set-up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Name      Value      Min      Max   Stderr     Vary     Expr Brute_Step
amp           7      2.5      inf     None     True     None     0.25
decay      0.05     -inf      inf     None     True     None    0.005
omega         3     -inf        5     None     True     None     0.25
shift         0   -1.571    1.571     None     True     None     None
</pre></div>
</div>
<p>First, we initialize a Minimizer and perform the grid search:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">fcn2min</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">fcn_args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
<span class="n">result_brute</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;brute&#39;</span><span class="p">,</span> <span class="n">Ns</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
<p>We used two new parameters here: <code class="docutils literal notranslate"><span class="pre">Ns</span></code> and <code class="docutils literal notranslate"><span class="pre">keep</span></code>. The parameter <code class="docutils literal notranslate"><span class="pre">Ns</span></code>
determines the ‘number of grid points along the axes’ similarly to its usage
in SciPy. Together with <code class="docutils literal notranslate"><span class="pre">brute_step</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> for a Parameter
it will dictate how the grid is set-up:</p>
<p><strong>(1)</strong> finite bounds are specified (“SciPy implementation”): uses
<code class="docutils literal notranslate"><span class="pre">brute_step</span></code> if present (in the example above) or uses <code class="docutils literal notranslate"><span class="pre">Ns</span></code> to generate
the grid. The latter scenario that interpolates <code class="docutils literal notranslate"><span class="pre">Ns</span></code> points from <code class="docutils literal notranslate"><span class="pre">min</span></code>
to <code class="docutils literal notranslate"><span class="pre">max</span></code> (inclusive), is here shown for the parameter <code class="docutils literal notranslate"><span class="pre">shift</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par_name</span> <span class="o">=</span> <span class="s1">&#39;shift&#39;</span>
<span class="n">indx_shift</span> <span class="o">=</span> <span class="n">result_brute</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">par_name</span><span class="p">)</span>
<span class="n">grid_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">indx_shift</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameter = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">number of steps = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">grid = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par_name</span><span class="p">,</span>
      <span class="nb">len</span><span class="p">(</span><span class="n">grid_shift</span><span class="p">),</span> <span class="n">grid_shift</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>parameter = shift
number of steps = 25
grid = [-1.57079633 -1.43989663 -1.30899694 -1.17809725 -1.04719755 -0.91629786
 -0.78539816 -0.65449847 -0.52359878 -0.39269908 -0.26179939 -0.13089969
  0.          0.13089969  0.26179939  0.39269908  0.52359878  0.65449847
  0.78539816  0.91629786  1.04719755  1.17809725  1.30899694  1.43989663
  1.57079633]
</pre></div>
</div>
<p>If finite bounds are not set for a certain parameter then the user <strong>must</strong>
specify <code class="docutils literal notranslate"><span class="pre">brute_step</span></code> - three more scenarios are considered here:</p>
<p><strong>(2)</strong> lower bound (min) and brute_step are specified:
range = (min, min + Ns * brute_step, brute_step)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par_name</span> <span class="o">=</span> <span class="s1">&#39;amp&#39;</span>
<span class="n">indx_shift</span> <span class="o">=</span> <span class="n">result_brute</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">par_name</span><span class="p">)</span>
<span class="n">grid_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">indx_shift</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameter = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">number of steps = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">grid = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid_shift</span><span class="p">),</span> <span class="n">grid_shift</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>parameter = amp
number of steps = 25
grid = [2.5  2.75 3.   3.25 3.5  3.75 4.   4.25 4.5  4.75 5.   5.25 5.5  5.75
 6.   6.25 6.5  6.75 7.   7.25 7.5  7.75 8.   8.25 8.5 ]
</pre></div>
</div>
<p><strong>(3)</strong> upper bound (max) and brute_step are specified:
range = (max - Ns * brute_step, max, brute_step)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par_name</span> <span class="o">=</span> <span class="s1">&#39;omega&#39;</span>
<span class="n">indx_shift</span> <span class="o">=</span> <span class="n">result_brute</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">par_name</span><span class="p">)</span>
<span class="n">grid_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">indx_shift</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameter = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">number of steps = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">grid = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid_shift</span><span class="p">),</span> <span class="n">grid_shift</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>parameter = omega
number of steps = 25
grid = [-1.25 -1.   -0.75 -0.5  -0.25  0.    0.25  0.5   0.75  1.    1.25  1.5
  1.75  2.    2.25  2.5   2.75  3.    3.25  3.5   3.75  4.    4.25  4.5
  4.75]
</pre></div>
</div>
<p><strong>(4)</strong> numerical value (value) and brute_step are specified:
range = (value - (Ns//2) * brute_step, value + (Ns//2) * brute_step, brute_step)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par_name</span> <span class="o">=</span> <span class="s1">&#39;decay&#39;</span>
<span class="n">indx_shift</span> <span class="o">=</span> <span class="n">result_brute</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">par_name</span><span class="p">)</span>
<span class="n">grid_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">indx_shift</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameter = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">number of steps = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">grid = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid_shift</span><span class="p">),</span> <span class="n">grid_shift</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>parameter = decay
number of steps = 24
grid = [-1.00000000e-02 -5.00000000e-03  5.20417043e-18  5.00000000e-03
  1.00000000e-02  1.50000000e-02  2.00000000e-02  2.50000000e-02
  3.00000000e-02  3.50000000e-02  4.00000000e-02  4.50000000e-02
  5.00000000e-02  5.50000000e-02  6.00000000e-02  6.50000000e-02
  7.00000000e-02  7.50000000e-02  8.00000000e-02  8.50000000e-02
  9.00000000e-02  9.50000000e-02  1.00000000e-01  1.05000000e-01]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MinimizerResult</span></code> contains all the usual best-fit parameters and
fitting statistics. For example, the optimal solution from the grid search
is given below together with a plot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fit_report</span><span class="p">(</span><span class="n">result_brute</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">fcn2min</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_example_brute_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_example_brute_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[Fit Statistics]]
    # fitting method   = brute
    # function evals   = 375000
    # data points      = 301
    # variables        = 4
    chi-square         = 11.9353671
    reduced chi-square = 0.04018642
    Akaike info crit   = -963.508878
    Bayesian info crit = -948.680437
##  Warning: uncertainties could not be estimated:
[[Variables]]
    amp:    5.00000000 (init = 7)
    decay:  0.02500000 (init = 0.05)
    shift: -0.13089969 (init = 0)
    omega:  2.00000000 (init = 3)
</pre></div>
</div>
<p>We can see that this fit is already very good, which is what we should expect
since our <code class="docutils literal notranslate"><span class="pre">brute</span></code> force grid is sampled rather finely and encompasses the
“correct” values.</p>
<p>In a more realistic, complicated example the <code class="docutils literal notranslate"><span class="pre">brute</span></code> method will be used
to get reasonable values for the parameters and perform another minimization
(e.g., using <code class="docutils literal notranslate"><span class="pre">leastsq</span></code>) using those as starting values. That is where the
<cite>keep`</cite> parameter comes into play: it determines the “number of best
candidates from the brute force method that are stored in the <code class="docutils literal notranslate"><span class="pre">candidates</span></code>
attribute”. In the example above we store the best-ranking 25 solutions (the
default value is <code class="docutils literal notranslate"><span class="pre">50</span></code> and storing all the grid points can be accomplished
by choosing <code class="docutils literal notranslate"><span class="pre">all</span></code>). The <code class="docutils literal notranslate"><span class="pre">candidates</span></code> attribute contains the parameters
and <code class="docutils literal notranslate"><span class="pre">chisqr</span></code> from the brute force method as a namedtuple,
<code class="docutils literal notranslate"><span class="pre">(‘Candidate’,</span> <span class="pre">[‘params’,</span> <span class="pre">‘score’])</span></code>, sorted on the (lowest) <code class="docutils literal notranslate"><span class="pre">chisqr</span></code>
value. To access the values for a particular candidate one can use
<code class="docutils literal notranslate"><span class="pre">result.candidate[#].params</span></code> or <code class="docutils literal notranslate"><span class="pre">result.candidate[#].score</span></code>, where a
lower # represents a better candidate. The <code class="docutils literal notranslate"><span class="pre">show_candidates(#)</span></code> uses the
<code class="docutils literal notranslate"><span class="pre">pretty_print()</span></code> method to show a specific candidate-# or all candidates
when no number is specified.</p>
<p>The optimal fit is, as usual, stored in the <code class="docutils literal notranslate"><span class="pre">MinimizerResult.params</span></code>
attribute and is, therefore, identical to <code class="docutils literal notranslate"><span class="pre">result_brute.show_candidates(1)</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_brute</span><span class="o">.</span><span class="n">show_candidates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Candidate #1, chisqr = 11.935
Name      Value      Min      Max   Stderr     Vary     Expr Brute_Step
amp           5      2.5      inf     None     True     None     0.25
decay     0.025     -inf      inf     None     True     None    0.005
omega         2     -inf        5     None     True     None     0.25
shift   -0.1309   -1.571    1.571     None     True     None     None
</pre></div>
</div>
<p>In this case, the next-best scoring candidate has already a <code class="docutils literal notranslate"><span class="pre">chisqr</span></code> that
increased quite a bit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_brute</span><span class="o">.</span><span class="n">show_candidates</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Candidate #2, chisqr = 13.994
Name      Value      Min      Max   Stderr     Vary     Expr Brute_Step
amp        4.75      2.5      inf     None     True     None     0.25
decay     0.025     -inf      inf     None     True     None    0.005
omega         2     -inf        5     None     True     None     0.25
shift   -0.1309   -1.571    1.571     None     True     None     None
</pre></div>
</div>
<p>and is, therefore, probably not so likely… However, as said above, in most
cases you’ll want to do another minimization using the solutions from the
<code class="docutils literal notranslate"><span class="pre">brute</span></code> method as starting values. That can be easily accomplished as
shown in the code below, where we now perform a <code class="docutils literal notranslate"><span class="pre">leastsq</span></code> minimization
starting from the top-25 solutions and accept the solution if the <code class="docutils literal notranslate"><span class="pre">chisqr</span></code>
is lower than the previously ‘optimal’ solution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">best_result</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">result_brute</span><span class="p">)</span>

<span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">result_brute</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">candidate</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">&lt;</span> <span class="n">best_result</span><span class="o">.</span><span class="n">chisqr</span><span class="p">:</span>
        <span class="n">best_result</span> <span class="o">=</span> <span class="n">trial</span>
</pre></div>
</div>
<p>From the <code class="docutils literal notranslate"><span class="pre">leastsq</span></code> minimization we obtain the following parameters for the
most optimal result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fit_report</span><span class="p">(</span><span class="n">best_result</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[Fit Statistics]]
    # fitting method   = leastsq
    # function evals   = 21
    # data points      = 301
    # variables        = 4
    chi-square         = 10.8653514
    reduced chi-square = 0.03658367
    Akaike info crit   = -991.780924
    Bayesian info crit = -976.952483
[[Variables]]
    amp:    5.00323088 +/- 0.03805940 (0.76%) (init = 5.25)
    decay:  0.02563850 +/- 4.4571e-04 (1.74%) (init = 0.025)
    shift: -0.09162988 +/- 0.00978382 (10.68%) (init = 0)
    omega:  1.99611629 +/- 0.00316225 (0.16%) (init = 2)
[[Correlations]] (unreported correlations are &lt; 0.100)
    C(shift, omega) = -0.785
    C(amp, decay)   =  0.584
    C(amp, shift)   = -0.121
</pre></div>
</div>
<p>As expected the parameters have not changed significantly as they were
already very close to the “real” values, which can also be appreciated from
the plots below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">fcn2min</span><span class="p">(</span><span class="n">result_brute</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;brute&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">fcn2min</span><span class="p">(</span><span class="n">best_result</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;brute followed by leastsq&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_example_brute_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_example_brute_003.png" />
<p>Finally, the results from the <code class="docutils literal notranslate"><span class="pre">brute</span></code> force grid-search can be visualized
using the rather lengthy Python function below (which might get incorporated
in lmfit at some point).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_results_brute</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">best_vals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varlabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize the result of the brute force grid search.</span>

<span class="sd">    The output file will display the chi-square value per parameter and contour</span>
<span class="sd">    plots for all combination of two parameters.</span>

<span class="sd">    Inspired by the `corner` package (https://github.com/dfm/corner.py).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result : :class:`~lmfit.minimizer.MinimizerResult`</span>
<span class="sd">        Contains the results from the :meth:`brute` method.</span>

<span class="sd">    best_vals : bool, optional</span>
<span class="sd">        Whether to show the best values from the grid search (default is True).</span>

<span class="sd">    varlabels : list, optional</span>
<span class="sd">        If None (default), use `result.var_names` as axis labels, otherwise</span>
<span class="sd">        use the names specified in `varlabels`.</span>

<span class="sd">    output : str, optional</span>
<span class="sd">        Name of the output PDF file (default is &#39;None&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">LogNorm</span>

    <span class="n">npars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">var_names</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">npars</span><span class="p">,</span> <span class="n">npars</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">varlabels</span><span class="p">:</span>
        <span class="n">varlabels</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">var_names</span>
    <span class="k">if</span> <span class="n">best_vals</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_vals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">best_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">par1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">var_names</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">par2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">var_names</span><span class="p">):</span>

            <span class="c1"># parameter vs chi2 in case of only one parameter</span>
            <span class="k">if</span> <span class="n">npars</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\chi^</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">varlabels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">best_vals</span><span class="p">:</span>
                    <span class="n">axes</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

            <span class="c1"># parameter vs chi2 profile on top</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">npars</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">red_axis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npars</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">red_axis</span><span class="p">),</span>
                        <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\chi^</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
                <span class="k">if</span> <span class="n">best_vals</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

            <span class="c1"># parameter vs chi2 profile on the left</span>
            <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">red_axis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npars</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">red_axis</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">varlabels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">npars</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">npars</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\chi^</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">best_vals</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

            <span class="c1"># contour plots for all combinations of two parameters</span>
            <span class="k">elif</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">red_axis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npars</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">j</span><span class="p">])</span>
                <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_grid</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">lvls1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
                <span class="n">lvls2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
                <span class="n">lvls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lvls1</span><span class="p">,</span> <span class="n">lvls2</span><span class="p">)))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">brute_Jout</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">red_axis</span><span class="p">),</span>
                            <span class="n">lvls</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">())</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
                <span class="k">if</span> <span class="n">best_vals</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_vals</span><span class="p">[</span><span class="n">par1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">best_vals</span><span class="p">[</span><span class="n">par2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;rs&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">npars</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">npars</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">varlabels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>and finally, to generated the figure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_results_brute</span><span class="p">(</span><span class="n">result_brute</span><span class="p">,</span> <span class="n">best_vals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varlabels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_example_brute_004.png" class="sphx-glr-single-img" src="../_images/sphx_glr_example_brute_004.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  21.147 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-example-brute-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c004866ac6395edd2609ff96cecdc255/example_brute.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_brute.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9254f2af7eef00978dc5823dc5418985/example_brute.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_brute.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="documentation/model_savemodel.html" title="doc_model_savemodel.py"
             >next</a> |</li>
        <li class="right" >
          <a href="lmfit_emcee_model_selection.html" title="Model Selection using lmfit and emcee"
             >previous</a> |</li>
   <li>[<a href="../intro.html">intro</a>|</li>
   <li><a href="../parameters.html">parameters</a>|</li>
   <li><a href="../fitting.html"> minimize</a>|</li>
   <li><a href="../model.html"> model</a>|</li>
   <li><a href="../builtin_models.html"> built-in models</a>|</li>
   <li><a href="../confidence.html">confidence intervals</a>|</li>
   <li><a href="../bounds.html">bounds</a>|</li>
   <li><a href="../constraints.html">constraints</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Examples gallery</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Matthew Newville, Till Stensitzki, and others.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>