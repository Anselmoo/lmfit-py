
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Performing Fits and Analyzing Outputs &#8212; Non-Linear Least-Squares Minimization and Curve-Fitting for Python</title>
    <link rel="stylesheet" href="_static/lmfitdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modeling Data and Curve Fitting" href="model.html" />
    <link rel="prev" title="Parameter and Parameters" href="parameters.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
        "HTML-CSS": {scale: 90}
  });</script>

  </head><body>
<div>
<table border=0>
  <tr><td></td><td width=85% padding=5 align=left>
       <a href="index.html" style="color: #157"> <font size=+3>LMFIT</font></a>
     </td>
     <td width=7% align=left>
         <a href="contents.html" style="color: #882222">
         <font size+=1>Contents</font></a> </td>
     <td width=7% align=left>
          <a href="installation.html" style="color: #882222">
          <font size+=1>Download</font></a></td>
     <td></td>
  </tr>
  <tr><td></td><td width=75% padding=5 align=left>
        <a href="index.html" style="color: #157"> <font size=+2>
	Non-Linear Least-Squares Minimization and Curve-Fitting for Python</font></a>
     </td>
     <td width=7% align=left>
         <a href="faq.html" style="color: #882222">
         <font size+=1>FAQ</font></a> </td>
     <td width=7% align=left>
        <a href="https://github.com/lmfit/lmfit-py/" style="color: #882222">
         <font size+=1>Develop</font></a></td>
     <td></td>
  </tr>
</table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="model.html" title="Modeling Data and Curve Fitting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="parameters.html" title="Parameter and Parameters"
             accesskey="P">previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="#"> minimize</a>|</li>
   <li><a href="model.html"> model</a>|</li>
   <li><a href="builtin_models.html"> built-in models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Performing Fits and Analyzing Outputs</a><ul>
<li><a class="reference internal" href="#the-minimize-function">The <code class="docutils literal notranslate"><span class="pre">minimize()</span></code> function</a></li>
<li><a class="reference internal" href="#writing-a-fitting-function">Writing a Fitting Function</a></li>
<li><a class="reference internal" href="#choosing-different-fitting-methods">Choosing Different Fitting Methods</a></li>
<li><a class="reference internal" href="#minimizerresult-the-optimization-result"><code class="docutils literal notranslate"><span class="pre">MinimizerResult</span></code> – the optimization result</a><ul>
<li><a class="reference internal" href="#goodness-of-fit-statistics">Goodness-of-Fit Statistics</a></li>
<li><a class="reference internal" href="#akaike-and-bayesian-information-criteria">Akaike and Bayesian Information Criteria</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-a-iteration-callback-function">Using a Iteration Callback Function</a></li>
<li><a class="reference internal" href="#using-the-minimizer-class">Using the <code class="docutils literal notranslate"><span class="pre">Minimizer</span></code> class</a></li>
<li><a class="reference internal" href="#minimizer-emcee-calculating-the-posterior-probability-distribution-of-parameters"><code class="docutils literal notranslate"><span class="pre">Minimizer.emcee()</span></code> - calculating the posterior probability distribution of parameters</a></li>
<li><a class="reference internal" href="#getting-and-printing-fit-reports">Getting and Printing Fit Reports</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="parameters.html"
                        title="previous chapter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code>  and <code class="docutils literal notranslate"><span class="pre">Parameters</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="model.html"
                        title="next chapter">Modeling Data and Curve Fitting</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/fitting.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-lmfit.minimizer"><span id="minimize-chapter"></span></span><div class="section" id="performing-fits-and-analyzing-outputs">
<h1>Performing Fits and Analyzing Outputs<a class="headerlink" href="#performing-fits-and-analyzing-outputs" title="Permalink to this headline">¶</a></h1>
<p>As shown in the previous chapter, a simple fit can be performed with the
<a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> function.  For more sophisticated modeling, the
<a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> class can be used to gain a bit more control, especially
when using complicated constraints or comparing results from related fits.</p>
<div class="section" id="the-minimize-function">
<h2>The <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> function<a class="headerlink" href="#the-minimize-function" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> function is a wrapper around <a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> for
running an optimization problem.  It takes an objective function (the
function that calculates the array to be minimized), a <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>
object, and several optional arguments.  See <a class="reference internal" href="#fit-func-label"><span class="std std-ref">Writing a Fitting Function</span></a> for
details on writing the objective function.</p>
<dl class="function">
<dt id="lmfit.minimizer.minimize">
<code class="descname">minimize</code><span class="sig-paren">(</span><em>fcn</em>, <em>params</em>, <em>method='leastsq'</em>, <em>args=None</em>, <em>kws=None</em>, <em>iter_cb=None</em>, <em>scale_covar=True</em>, <em>nan_policy='raise'</em>, <em>reduce_fcn=None</em>, <em>calc_covar=True</em>, <em>**fit_kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a fit of a set of parameters by minimizing an objective (or
cost) function using one of the several available methods.</p>
<p>The minimize function takes an objective function to be minimized,
a dictionary (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) containing the model
parameters, and several optional arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fcn</strong> (<em>callable</em>) – Objective function to be minimized. When method is <cite>leastsq</cite> or
<cite>least_squares</cite>, the objective function should return an array
of residuals (difference between model and data) to be minimized
in a least-squares sense. With the scalar methods the objective
function can either return the residuals array or a single scalar
value. The function must have the signature:
<cite>fcn(params, *args, **kws)</cite></li>
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) – Contains the Parameters for the model.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Name of the fitting method to use. Valid values are:</p>
<ul>
<li><cite>’leastsq’</cite>: Levenberg-Marquardt (default)</li>
<li><cite>’least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</li>
<li><cite>’differential_evolution’</cite>: differential evolution</li>
<li><cite>’brute’</cite>: brute force method</li>
<li><cite>’basinhopping’</cite>: basinhopping</li>
<li><cite>’ampgo’</cite>: Adaptive Memory Programming for Global Optimization</li>
<li>’<cite>nelder</cite>’: Nelder-Mead</li>
<li><cite>’lbfgsb’</cite>: L-BFGS-B</li>
<li><cite>’powell’</cite>: Powell</li>
<li><cite>’cg’</cite>: Conjugate-Gradient</li>
<li><cite>’newton’</cite>: Newton-CG</li>
<li><cite>’cobyla’</cite>: Cobyla</li>
<li><cite>’bfgs’</cite>: BFGS</li>
<li><cite>’tnc’</cite>: Truncated Newton</li>
<li><cite>’trust-ncg’</cite>: Newton-CG trust-region</li>
<li><cite>’trust-exact’</cite>: nearly exact trust-region (SciPy &gt;= 1.0)</li>
<li><cite>’trust-krylov’</cite>: Newton GLTR trust-region (SciPy &gt;= 1.0)</li>
<li><cite>’trust-constr’</cite>: trust-region for constrained optimization (SciPy &gt;= 1.1)</li>
<li><cite>’dogleg’</cite>: Dog-leg trust-region</li>
<li><cite>’slsqp’</cite>: Sequential Linear Squares Programming</li>
<li><cite>’emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</li>
</ul>
<p>In most cases, these methods wrap and use the method of the same
name from <cite>scipy.optimize</cite>, or use <cite>scipy.optimize.minimize</cite> with
the same <cite>method</cite> argument.  Thus ‘<cite>leastsq</cite>’ will use
<cite>scipy.optimize.leastsq</cite>, while ‘<cite>powell</cite>’ will use
<cite>scipy.optimize.minimizer(…, method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</li>
<li><strong>args</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Positional arguments to pass to <cite>fcn</cite>.</li>
<li><strong>kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Keyword arguments to pass to <cite>fcn</cite>.</li>
<li><strong>iter_cb</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function to be called at each fit iteration. This function should
have the signature <cite>iter_cb(params, iter, resid, *args, **kws)</cite>,
where <cite>params</cite> will have the current parameter values, <cite>iter</cite>
the iteration number, <cite>resid</cite> the current residual array, and <cite>*args</cite>
and <cite>**kws</cite> as passed to the objective function.</li>
<li><strong>scale_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to automatically scale the covariance matrix (default is True).</li>
<li><strong>nan_policy</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Specifies action if <cite>userfcn</cite> (or a Jacobian) returns NaN
values. One of:</p>
<ul>
<li>’raise’ : a <cite>ValueError</cite> is raised</li>
<li>’propagate’ : the values returned from <cite>userfcn</cite> are un-altered</li>
<li>’omit’ : non-finite values are filtered</li>
</ul>
</li>
<li><strong>reduce_fcn</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>callable</em><em>, </em><em>optional</em>) – Function to convert a residual array to a scalar value for the scalar
minimizers. See notes in <cite>Minimizer</cite>.</li>
<li><strong>calc_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to calculate the covariance matrix (default is True) for
solvers other than <cite>leastsq</cite> and <cite>least_squares</cite>. Requires the
<cite>numdifftools</cite> package to be installed.</li>
<li><strong>**fit_kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Options to pass to the minimizer being used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p class="rubric">Notes</p>
<p>The objective function should return the value to be minimized. For the
Levenberg-Marquardt algorithm from leastsq(), this returned value must
be an array, with a length greater than or equal to the number of
fitting variables in the model. For the other methods, the return value
can either be a scalar or an array. If an array is returned, the sum of
squares of the array will be sent to the underlying fitting method,
effectively doing a least-squares optimization of the return values.</p>
<p>A common use for <cite>args</cite> and <cite>kws</cite> would be to pass in other
data needed to calculate the residual, including such things as the
data array, dependent variable, uncertainties in the data, and other
data structures for the model calculation.</p>
<p>On output, <cite>params</cite> will be unchanged.  The best-fit values and, where
appropriate, estimated uncertainties and correlations, will all be
contained in the returned <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.  See
<a class="reference internal" href="#fit-results-label"><span class="std std-ref">MinimizerResult – the optimization result</span></a> for further details.</p>
<p>This function is simply a wrapper around <a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a>
and is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">fcn_args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">fcn_kws</span><span class="o">=</span><span class="n">kws</span><span class="p">,</span>
                   <span class="n">iter_cb</span><span class="o">=</span><span class="n">iter_cb</span><span class="p">,</span> <span class="n">scale_covar</span><span class="o">=</span><span class="n">scale_covar</span><span class="p">,</span>
                   <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span> <span class="n">reduce_fcn</span><span class="o">=</span><span class="n">reduce_fcn</span><span class="p">,</span>
                   <span class="n">calc_covar</span><span class="o">=</span><span class="n">calc_covar</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_kws</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="writing-a-fitting-function">
<span id="fit-func-label"></span><h2>Writing a Fitting Function<a class="headerlink" href="#writing-a-fitting-function" title="Permalink to this headline">¶</a></h2>
<p>An important component of a fit is writing a function to be minimized –
the <em>objective function</em>.  Since this function will be called by other
routines, there are fairly stringent requirements for its call signature
and return value.  In principle, your function can be any Python callable,
but it must look like this:</p>
<dl class="function">
<dt>
<code class="descname">func(params, *args, **kws):</code></dt>
<dd><p>Calculate objective residual to be minimized from parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) – Parameters.</li>
<li><strong>args</strong> – Positional arguments.  Must match <code class="docutils literal notranslate"><span class="pre">args</span></code> argument to <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a>.</li>
<li><strong>kws</strong> – Keyword arguments.  Must match <code class="docutils literal notranslate"><span class="pre">kws</span></code> argument to <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Residual array (generally data-model) to be minimized in the least-squares sense.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray.  The length of this array cannot change between calls.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>A common use for the positional and keyword arguments would be to pass in other
data needed to calculate the residual, including things as the data array,
dependent variable, uncertainties in the data, and other data structures for the
model calculation.</p>
<p>The objective function should return the value to be minimized.  For the
Levenberg-Marquardt algorithm from <code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code>, this returned value <strong>must</strong> be an
array, with a length greater than or equal to the number of fitting variables in the
model.  For the other methods, the return value can either be a scalar or an array.  If an
array is returned, the sum of squares of the array will be sent to the underlying fitting
method, effectively doing a least-squares optimization of the return values.</p>
<p>Since the function will be passed in a dictionary of <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, it is advisable
to unpack these to get numerical values at the top of the function.  A
simple way to do this is with <code class="xref py py-meth docutils literal notranslate"><span class="pre">Parameters.valuesdict()</span></code>, as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
    <span class="c1"># unpack parameters: extract .value attribute for each parameter</span>
    <span class="n">parvals</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
    <span class="n">period</span> <span class="o">=</span> <span class="n">parvals</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">parvals</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span>
    <span class="n">decay</span> <span class="o">=</span> <span class="n">parvals</span><span class="p">[</span><span class="s1">&#39;decay&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">-</span> <span class="n">sign</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span>

    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-10</span><span class="p">:</span>
        <span class="n">period</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e-10</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">parvals</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">shift</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="n">period</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">decay</span><span class="o">*</span><span class="n">decay</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span>
    <span class="k">if</span> <span class="n">eps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span> <span class="o">-</span> <span class="n">data</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">model</span><span class="o">-</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
</pre></div>
</div>
<p>In this example, <cite>x</cite> is a positional (required) argument, while the
<cite>data</cite> array is actually optional (so that the function returns the model
calculation if the data is neglected).  Also note that the model
calculation will divide <cite>x</cite> by the value of the <code class="docutils literal notranslate"><span class="pre">period</span></code> Parameter.  It
might be wise to ensure this parameter cannot be 0.  It would be possible
to use bounds on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code> to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">1.e-10</span><span class="p">)</span>
</pre></div>
</div>
<p>but putting this directly in the function with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-10</span><span class="p">:</span>
    <span class="n">period</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e-10</span>
</pre></div>
</div>
<p>is also a reasonable approach.   Similarly, one could place bounds on the
<code class="docutils literal notranslate"><span class="pre">decay</span></code> parameter to take values only between <code class="docutils literal notranslate"><span class="pre">-pi/2</span></code> and <code class="docutils literal notranslate"><span class="pre">pi/2</span></code>.</p>
</div>
<div class="section" id="choosing-different-fitting-methods">
<span id="fit-methods-label"></span><h2>Choosing Different Fitting Methods<a class="headerlink" href="#choosing-different-fitting-methods" title="Permalink to this headline">¶</a></h2>
<p>By default, the <a class="reference external" href="https://en.wikipedia.org/wiki/Levenberg-Marquardt_algorithm">Levenberg-Marquardt</a> algorithm is
used for fitting.  While often criticized, including the fact it finds a
<em>local</em> minima, this approach has some distinct advantages.  These include
being fast, and well-behaved for most curve-fitting needs, and making it
easy to estimate uncertainties for and correlations between pairs of fit
variables, as discussed in <a class="reference internal" href="#fit-results-label"><span class="std std-ref">MinimizerResult – the optimization result</span></a>.</p>
<p>Alternative algorithms can also be used by providing the <code class="docutils literal notranslate"><span class="pre">method</span></code>
keyword to the <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> function or <a class="reference internal" href="#lmfit.minimizer.Minimizer.minimize" title="lmfit.minimizer.Minimizer.minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a>
class as listed in the <a class="reference internal" href="#fit-methods-table"><span class="std std-ref">Table of Supported Fitting Methods</span></a>. If you have the <cite>numdifftools</cite> package installed, lmfit
will try to estimate the covariance matrix and determine parameter
uncertainties and correlations if <cite>calc_covar</cite> is True (default).</p>
<blockquote id="fit-methods-table">
<div><p>Table of Supported Fitting Methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Fitting Method</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">method</span></code> arg to <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> or <a class="reference internal" href="#lmfit.minimizer.Minimizer.minimize" title="lmfit.minimizer.Minimizer.minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Levenberg-Marquardt</td>
<td><code class="docutils literal notranslate"><span class="pre">leastsq</span></code> or <code class="docutils literal notranslate"><span class="pre">least_squares</span></code></td>
</tr>
<tr class="row-odd"><td>Nelder-Mead</td>
<td><code class="docutils literal notranslate"><span class="pre">nelder</span></code></td>
</tr>
<tr class="row-even"><td>L-BFGS-B</td>
<td><code class="docutils literal notranslate"><span class="pre">lbfgsb</span></code></td>
</tr>
<tr class="row-odd"><td>Powell</td>
<td><code class="docutils literal notranslate"><span class="pre">powell</span></code></td>
</tr>
<tr class="row-even"><td>Conjugate Gradient</td>
<td><code class="docutils literal notranslate"><span class="pre">cg</span></code></td>
</tr>
<tr class="row-odd"><td>Newton-CG</td>
<td><code class="docutils literal notranslate"><span class="pre">newton</span></code></td>
</tr>
<tr class="row-even"><td>COBYLA</td>
<td><code class="docutils literal notranslate"><span class="pre">cobyla</span></code></td>
</tr>
<tr class="row-odd"><td>BFGS</td>
<td><code class="docutils literal notranslate"><span class="pre">bfgsb</span></code></td>
</tr>
<tr class="row-even"><td>Truncated Newton</td>
<td><code class="docutils literal notranslate"><span class="pre">tnc</span></code></td>
</tr>
<tr class="row-odd"><td>Newton CG trust-region</td>
<td><code class="docutils literal notranslate"><span class="pre">trust-ncg</span></code></td>
</tr>
<tr class="row-even"><td>Exact trust-region</td>
<td><code class="docutils literal notranslate"><span class="pre">trust-exact</span></code> (SciPy &gt;= 1.0)</td>
</tr>
<tr class="row-odd"><td>Newton GLTR trust-region</td>
<td><code class="docutils literal notranslate"><span class="pre">trust-krylov</span></code> (SciPy &gt;= 1.0)</td>
</tr>
<tr class="row-even"><td>Constrained trust-region</td>
<td><code class="docutils literal notranslate"><span class="pre">trust-constr</span></code> (SciPy &gt;= 1.1)</td>
</tr>
<tr class="row-odd"><td>Dogleg</td>
<td><code class="docutils literal notranslate"><span class="pre">dogleg</span></code></td>
</tr>
<tr class="row-even"><td>Sequential Linear
Squares Programming</td>
<td><code class="docutils literal notranslate"><span class="pre">slsqp</span></code></td>
</tr>
<tr class="row-odd"><td>Differential
Evolution</td>
<td><code class="docutils literal notranslate"><span class="pre">differential_evolution</span></code></td>
</tr>
<tr class="row-even"><td>Brute force method</td>
<td><code class="docutils literal notranslate"><span class="pre">brute</span></code></td>
</tr>
<tr class="row-odd"><td>Basinhopping</td>
<td><code class="docutils literal notranslate"><span class="pre">basinhopping</span></code></td>
</tr>
<tr class="row-even"><td>Adaptive Memory
Programming for Global
Optimization</td>
<td><code class="docutils literal notranslate"><span class="pre">ampgo</span></code></td>
</tr>
<tr class="row-odd"><td>Maximum likelihood via
Monte-Carlo Markov Chain</td>
<td><code class="docutils literal notranslate"><span class="pre">emcee</span></code></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The objective function for the Levenberg-Marquardt method <strong>must</strong>
return an array, with more elements than variables.  All other methods
can return either a scalar value or an array. The Monte-Carlo Markov
Chain or <code class="docutils literal notranslate"><span class="pre">emcee</span></code> method has two different operating methods when the
objective function returns a scalar value. See the documentation for <code class="docutils literal notranslate"><span class="pre">emcee</span></code>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Much of this documentation assumes that the Levenberg-Marquardt (<cite>leastsq</cite>)
method is used. Many of the fit statistics and estimates for uncertainties in
parameters discussed in <a class="reference internal" href="#fit-results-label"><span class="std std-ref">MinimizerResult – the optimization result</span></a> are done only unconditionally
for this (and the <cite>least_squares</cite>) method. Lmfit versions newer than 0.9.11
provide the capability to use <cite>numdifftools</cite> to estimate the covariance matrix
and calculate parameter uncertainties and correlations for other methods as
well.</p>
</div>
</div>
<div class="section" id="minimizerresult-the-optimization-result">
<span id="fit-results-label"></span><h2><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> – the optimization result<a class="headerlink" href="#minimizerresult-the-optimization-result" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.0.</span></p>
</div>
<p>An optimization with <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> or <a class="reference internal" href="#lmfit.minimizer.Minimizer.minimize" title="lmfit.minimizer.Minimizer.minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a>
will return a <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> object.  This is an otherwise
plain container object (that is, with no methods of its own) that
simply holds the results of the minimization.  These results will
include several pieces of informational data such as status and error
messages, fit statistics, and the updated parameters themselves.</p>
<p>Importantly, the parameters passed in to <a class="reference internal" href="#lmfit.minimizer.Minimizer.minimize" title="lmfit.minimizer.Minimizer.minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a>
will be not be changed.  To find the best-fit values, uncertainties
and so on for each parameter, one must use the
<a class="reference internal" href="#lmfit.minimizer.MinimizerResult.params" title="lmfit.minimizer.MinimizerResult.params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinimizerResult.params</span></code></a> attribute. For example, to print the
fitted values, bounds and other parameter attributes in a
well-formatted text tables you can execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
<p>with <cite>results</cite> being a <cite>MinimizerResult</cite> object. Note that the method
<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters.pretty_print" title="lmfit.parameter.Parameters.pretty_print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code></a> accepts several arguments
for customizing the output (e.g., column width, numeric format, etcetera).</p>
<dl class="class">
<dt id="lmfit.minimizer.MinimizerResult">
<em class="property">class </em><code class="descname">MinimizerResult</code><span class="sig-paren">(</span><em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.MinimizerResult" title="Permalink to this definition">¶</a></dt>
<dd><p>The results of a minimization.</p>
<p>Minimization results include data such as status and error messages,
fit statistics, and the updated (i.e., best-fit) parameters themselves
in the <a class="reference internal" href="#lmfit.minimizer.MinimizerResult.params" title="lmfit.minimizer.MinimizerResult.params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code></a> attribute.</p>
<p>The list of (possible) <cite>MinimizerResult</cite> attributes is given below:</p>
<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.params">
<code class="descname">params</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.params" title="Permalink to this definition">¶</a></dt>
<dd><p>The best-fit parameters resulting from the fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.status">
<code class="descname">status</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Termination status of the optimizer. Its value depends on the
underlying solver. Refer to <cite>message</cite> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.var_names">
<code class="descname">var_names</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.var_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered list of variable parameter names used in optimization, and
useful for understanding the values in <a class="reference internal" href="#lmfit.minimizer.MinimizerResult.init_vals" title="lmfit.minimizer.MinimizerResult.init_vals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">init_vals</span></code></a> and
<a class="reference internal" href="#lmfit.minimizer.MinimizerResult.covar" title="lmfit.minimizer.MinimizerResult.covar"><code class="xref py py-attr docutils literal notranslate"><span class="pre">covar</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.covar">
<code class="descname">covar</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.covar" title="Permalink to this definition">¶</a></dt>
<dd><p>Covariance matrix from minimization, with rows and columns
corresponding to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult.var_names" title="lmfit.minimizer.MinimizerResult.var_names"><code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)">numpy.ndarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.init_vals">
<code class="descname">init_vals</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.init_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>List of initial values for variable parameters using <a class="reference internal" href="#lmfit.minimizer.MinimizerResult.var_names" title="lmfit.minimizer.MinimizerResult.var_names"><code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.init_values">
<code class="descname">init_values</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.init_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of initial values for variable parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.nfev">
<code class="descname">nfev</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.nfev" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of function evaluations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.success">
<code class="descname">success</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.success" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the fit succeeded, otherwise False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.errorbars">
<code class="descname">errorbars</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.errorbars" title="Permalink to this definition">¶</a></dt>
<dd><p>True if uncertainties were estimated, otherwise False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.message">
<code class="descname">message</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Message about fit success.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.ier">
<code class="descname">ier</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.ier" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer error value from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a> (<cite>leastsq</cite> only).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.lmdif_message">
<code class="descname">lmdif_message</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.lmdif_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Message from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a> (<cite>leastsq</cite> only).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.nvarys">
<code class="descname">nvarys</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.nvarys" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of variables in fit: <span class="math notranslate nohighlight">\(N_{\rm varys}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.ndata">
<code class="descname">ndata</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.ndata" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of data points: <span class="math notranslate nohighlight">\(N\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.nfree">
<code class="descname">nfree</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.nfree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degrees of freedom in fit: <span class="math notranslate nohighlight">\(N - N_{\rm varys}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.residual">
<code class="descname">residual</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Residual array <span class="math notranslate nohighlight">\({\rm Resid_i}\)</span>. Return value of the objective
function when using the best-fit values of the parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)">numpy.ndarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.chisqr">
<code class="descname">chisqr</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.chisqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Chi-square: <span class="math notranslate nohighlight">\(\chi^2 = \sum_i^N [{\rm Resid}_i]^2\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.redchi">
<code class="descname">redchi</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.redchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduced chi-square:
<span class="math notranslate nohighlight">\(\chi^2_{\nu}= {\chi^2} / {(N - N_{\rm varys})}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.aic">
<code class="descname">aic</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.aic" title="Permalink to this definition">¶</a></dt>
<dd><p>Akaike Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + 2 N_{\rm varys}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.bic">
<code class="descname">bic</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.bic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + \ln(N) N_{\rm varys}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lmfit.minimizer.MinimizerResult.flatchain">
<code class="descname">flatchain</code><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.flatchain" title="Permalink to this definition">¶</a></dt>
<dd><p>A flatchain view of the sampling chain from the <cite>emcee</cite> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.MinimizerResult.show_candidates">
<code class="descname">show_candidates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.MinimizerResult.show_candidates" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty_print() representation of candidates from the <cite>brute</cite> method.</p>
</dd></dl>

</dd></dl>

<div class="section" id="goodness-of-fit-statistics">
<h3>Goodness-of-Fit Statistics<a class="headerlink" href="#goodness-of-fit-statistics" title="Permalink to this headline">¶</a></h3>
<blockquote id="goodfit-table">
<div>Table of Fit Results:  These values, including the standard Goodness-of-Fit statistics,
are all attributes of the <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> object returned by
<a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> or <a class="reference internal" href="#lmfit.minimizer.Minimizer.minimize" title="lmfit.minimizer.Minimizer.minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a>.</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute Name</th>
<th class="head">Description / Formula</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>nfev</td>
<td>number of function evaluations</td>
</tr>
<tr class="row-odd"><td>nvarys</td>
<td>number of variables in fit  <span class="math notranslate nohighlight">\(N_{\rm varys}\)</span></td>
</tr>
<tr class="row-even"><td>ndata</td>
<td>number of data points:  <span class="math notranslate nohighlight">\(N\)</span></td>
</tr>
<tr class="row-odd"><td>nfree</td>
<td>degrees of freedom in fit:  <span class="math notranslate nohighlight">\(N - N_{\rm varys}\)</span></td>
</tr>
<tr class="row-even"><td>residual</td>
<td>residual array, returned by the objective function: <span class="math notranslate nohighlight">\(\{\rm Resid_i\}\)</span></td>
</tr>
<tr class="row-odd"><td>chisqr</td>
<td>chi-square: <span class="math notranslate nohighlight">\(\chi^2 = \sum_i^N [{\rm Resid}_i]^2\)</span></td>
</tr>
<tr class="row-even"><td>redchi</td>
<td>reduced chi-square: <span class="math notranslate nohighlight">\(\chi^2_{\nu}= {\chi^2} / {(N - N_{\rm varys})}\)</span></td>
</tr>
<tr class="row-odd"><td>aic</td>
<td>Akaike Information Criterion statistic (see below)</td>
</tr>
<tr class="row-even"><td>bic</td>
<td>Bayesian Information Criterion statistic (see below)</td>
</tr>
<tr class="row-odd"><td>var_names</td>
<td>ordered list of variable parameter names used for init_vals and covar</td>
</tr>
<tr class="row-even"><td>covar</td>
<td>covariance matrix (with rows/columns using var_names)</td>
</tr>
<tr class="row-odd"><td>init_vals</td>
<td>list of initial values for variable parameters</td>
</tr>
</tbody>
</table>
<p>Note that the calculation of chi-square and reduced chi-square assume
that the returned residual function is scaled properly to the
uncertainties in the data.  For these statistics to be meaningful, the
person writing the function to be minimized <strong>must</strong> scale them properly.</p>
<p>After a fit using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">least_squares()</span></code> method has
completed successfully, standard errors for the fitted variables and
correlations between pairs of fitted variables are automatically calculated from
the covariance matrix. For other methods, the <cite>calc_covar</cite> parameter (default is
True) in the <a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> class determines whether or not to use the
<cite>numdifftools</cite> package to estimate the covariance matrix. The standard error
(estimated <span class="math notranslate nohighlight">\(1\sigma\)</span> error-bar) goes into the <code class="xref py py-attr docutils literal notranslate"><span class="pre">stderr</span></code> attribute of
the Parameter. The correlations with all other variables will be put into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">correl</span></code> attribute of the Parameter – a dictionary with keys for all
other Parameters and values of the corresponding correlation.</p>
<p>In some cases, it may not be possible to estimate the errors and
correlations.  For example, if a variable actually has no practical effect
on the fit, it will likely cause the covariance matrix to be singular,
making standard errors impossible to estimate.  Placing bounds on varied
Parameters makes it more likely that errors cannot be estimated, as being
near the maximum or minimum value makes the covariance matrix singular.  In
these cases, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">errorbars</span></code> attribute of the fit result
(<a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> object) will be <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
<div class="section" id="akaike-and-bayesian-information-criteria">
<span id="information-criteria-label"></span><h3>Akaike and Bayesian Information Criteria<a class="headerlink" href="#akaike-and-bayesian-information-criteria" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> includes the traditional chi-square and reduced chi-square statistics:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
     \chi^2  &amp;=&amp;  \sum_i^N r_i^2 \\
     \chi^2_\nu &amp;=&amp; = \chi^2 / (N-N_{\rm varys})
 \end{eqnarray*}</div><p>where <span class="math notranslate nohighlight">\(r\)</span> is the residual array returned by the objective function
(likely to be <code class="docutils literal notranslate"><span class="pre">(data-model)/uncertainty</span></code> for data modeling usages),
<span class="math notranslate nohighlight">\(N\)</span> is the number of data points (<code class="docutils literal notranslate"><span class="pre">ndata</span></code>), and <span class="math notranslate nohighlight">\(N_{\rm
varys}\)</span> is number of variable parameters.</p>
<p>Also included are the <a class="reference external" href="https://en.wikipedia.org/wiki/Akaike_information_criterion">Akaike Information Criterion</a>, and
<a class="reference external" href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayesian Information Criterion</a> statistics,
held in the <code class="docutils literal notranslate"><span class="pre">aic</span></code> and <code class="docutils literal notranslate"><span class="pre">bic</span></code> attributes, respectively.  These give slightly
different measures of the relative quality for a fit, trying to balance
quality of fit with the number of variable parameters used in the fit.
These are calculated as:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
  {\rm aic} &amp;=&amp;  N \ln(\chi^2/N) + 2 N_{\rm varys} \\
  {\rm bic} &amp;=&amp;  N \ln(\chi^2/N) + \ln(N) N_{\rm varys} \\
 \end{eqnarray*}</div><p>When comparing fits with different numbers of varying parameters, one
typically selects the model with lowest reduced chi-square, Akaike
information criterion, and/or Bayesian information criterion.  Generally,
the Bayesian information criterion is considered the most conservative of
these statistics.</p>
</div>
</div>
<div class="section" id="using-a-iteration-callback-function">
<span id="fit-itercb-label"></span><h2>Using a Iteration Callback Function<a class="headerlink" href="#using-a-iteration-callback-function" title="Permalink to this headline">¶</a></h2>
<p>An iteration callback function is a function to be called at each
iteration, just after the objective function is called.  The iteration
callback allows user-supplied code to be run at each iteration, and can be
used to abort a fit.</p>
<dl class="function">
<dt>
<code class="descname">iter_cb(params, iter, resid, *args, **kws):</code></dt>
<dd><p>User-supplied function to be run at each iteration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) – Parameters.</li>
<li><strong>iter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Iteration number.</li>
<li><strong>resid</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><em>numpy.ndarray</em></a>) – Residual array.</li>
<li><strong>args</strong> – Positional arguments.  Must match <code class="docutils literal notranslate"><span class="pre">args</span></code> argument to <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a></li>
<li><strong>kws</strong> – Keyword arguments.  Must match <code class="docutils literal notranslate"><span class="pre">kws</span></code> argument to <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Residual array (generally data-model) to be minimized in the least-squares sense.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None for normal behavior, any value like True to abort the fit.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Normally, the iteration callback would have no return value or return
<code class="docutils literal notranslate"><span class="pre">None</span></code>.  To abort a fit, have this function return a value that is
<code class="docutils literal notranslate"><span class="pre">True</span></code> (including any non-zero integer).  The fit will also abort if any
exception is raised in the iteration callback. When a fit is aborted this
way, the parameters will have the values from the last iteration.  The fit
statistics are not likely to be meaningful, and uncertainties will not be computed.</p>
</div>
<div class="section" id="using-the-minimizer-class">
<span id="fit-minimizer-label"></span><h2>Using the <a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> class<a class="headerlink" href="#using-the-minimizer-class" title="Permalink to this headline">¶</a></h2>
<p>For full control of the fitting process, you will want to create a
<a class="reference internal" href="#lmfit.minimizer.Minimizer" title="lmfit.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a> object.</p>
<dl class="class">
<dt id="lmfit.minimizer.Minimizer">
<em class="property">class </em><code class="descname">Minimizer</code><span class="sig-paren">(</span><em>userfcn</em>, <em>params</em>, <em>fcn_args=None</em>, <em>fcn_kws=None</em>, <em>iter_cb=None</em>, <em>scale_covar=True</em>, <em>nan_policy='raise'</em>, <em>reduce_fcn=None</em>, <em>calc_covar=True</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>A general minimizer for curve fitting and optimization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>userfcn</strong> (<em>callable</em>) – <p>Objective function that returns the residual (difference between
model and data) to be minimized in a least-squares sense.  This
function must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">userfcn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">fcn_args</span><span class="p">,</span> <span class="o">**</span><span class="n">fcn_kws</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) – Contains the Parameters for the model.</li>
<li><strong>fcn_args</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Positional arguments to pass to <cite>userfcn</cite>.</li>
<li><strong>fcn_kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Keyword arguments to pass to <cite>userfcn</cite>.</li>
<li><strong>iter_cb</strong> (<em>callable</em><em>, </em><em>optional</em>) – <p>Function to be called at each fit iteration. This function should
have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iter_cb</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">resid</span><span class="p">,</span> <span class="o">*</span><span class="n">fcn_args</span><span class="p">,</span> <span class="o">**</span><span class="n">fcn_kws</span><span class="p">)</span>
</pre></div>
</div>
<p>where <cite>params</cite> will have the current parameter values, <cite>iter</cite>
the iteration number, <cite>resid</cite> the current residual array, and <cite>*fcn_args</cite>
and <cite>**fcn_kws</cite> are passed to the objective function.</p>
</li>
<li><strong>scale_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to automatically scale the covariance matrix (default is True).</li>
<li><strong>nan_policy</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Specifies action if <cite>userfcn</cite> (or a Jacobian) returns NaN
values. One of:</p>
<ul>
<li>’raise’ : a <cite>ValueError</cite> is raised</li>
<li>’propagate’ : the values returned from <cite>userfcn</cite> are un-altered</li>
<li>’omit’ : non-finite values are filtered</li>
</ul>
</li>
<li><strong>reduce_fcn</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>callable</em><em>, </em><em>optional</em>) – <p>Function to convert a residual array to a scalar value for the scalar
minimizers. Optional values are (where <cite>r</cite> is the residual array):</p>
<ul>
<li>None : sum of squares of residual [default]<blockquote>
<div>= (r*r).sum()</div></blockquote>
</li>
<li>’negentropy’ : neg entropy, using normal distribution<blockquote>
<div>= rho*log(rho).sum()`, where  rho = exp(-r*r/2)/(sqrt(2*pi))</div></blockquote>
</li>
<li>’neglogcauchy’: neg log likelihood, using Cauchy distribution<blockquote>
<div>= -log(1/(pi*(1+r*r))).sum()</div></blockquote>
</li>
<li>callable : must take one argument (<cite>r</cite>) and return a float.</li>
</ul>
</li>
<li><strong>calc_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to calculate the covariance matrix (default is True) for
solvers other than <cite>leastsq</cite> and <cite>least_squares</cite>. Requires the
<cite>numdifftools</cite> package to be installed.</li>
<li><strong>**kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Options to pass to the minimizer being used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The objective function should return the value to be minimized. For
the Levenberg-Marquardt algorithm from <a class="reference internal" href="#lmfit.minimizer.Minimizer.leastsq" title="lmfit.minimizer.Minimizer.leastsq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code></a> or
<a class="reference internal" href="#lmfit.minimizer.Minimizer.least_squares" title="lmfit.minimizer.Minimizer.least_squares"><code class="xref py py-meth docutils literal notranslate"><span class="pre">least_squares()</span></code></a>, this returned value must be an array, with a
length greater than or equal to the number of fitting variables in
the model. For the other methods, the return value can either be a
scalar or an array. If an array is returned, the sum of squares of
the array will be sent to the underlying fitting method, effectively
doing a least-squares optimization of the return values. If the
objective function returns non-finite values then a <cite>ValueError</cite>
will be raised because the underlying solvers cannot deal with them.</p>
<p>A common use for the <cite>fcn_args</cite> and <cite>fcn_kws</cite> would be to pass in
other data needed to calculate the residual, including such things
as the data array, dependent variable, uncertainties in the data,
and other data structures for the model calculation.</p>
</dd></dl>

<p>The Minimizer object has a few public methods:</p>
<dl class="method">
<dt id="lmfit.minimizer.Minimizer.minimize">
<code class="descclassname">Minimizer.</code><code class="descname">minimize</code><span class="sig-paren">(</span><em>method='leastsq'</em>, <em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the minimization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Name of the fitting method to use. Valid values are:</p>
<ul>
<li><cite>’leastsq’</cite>: Levenberg-Marquardt (default)</li>
<li><cite>’least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</li>
<li><cite>’differential_evolution’</cite>: differential evolution</li>
<li><cite>’brute’</cite>: brute force method</li>
<li><cite>’basinhopping’</cite>: basinhopping</li>
<li><cite>’ampgo’</cite>: Adaptive Memory Programming for Global Optimization</li>
<li>’<cite>nelder</cite>’: Nelder-Mead</li>
<li><cite>’lbfgsb’</cite>: L-BFGS-B</li>
<li><cite>’powell’</cite>: Powell</li>
<li><cite>’cg’</cite>: Conjugate-Gradient</li>
<li><cite>’newton’</cite>: Newton-CG</li>
<li><cite>’cobyla’</cite>: Cobyla</li>
<li><cite>’bfgs’</cite>: BFGS</li>
<li><cite>’tnc’</cite>: Truncated Newton</li>
<li><cite>’trust-ncg’</cite>: Newton-CG trust-region</li>
<li><cite>’trust-exact’</cite>: nearly exact trust-region (SciPy &gt;= 1.0)</li>
<li><cite>’trust-krylov’</cite>: Newton GLTR trust-region (SciPy &gt;= 1.0)</li>
<li><cite>’trust-constr’</cite>: trust-region for constrained optimization (SciPy &gt;= 1.1)</li>
<li><cite>’dogleg’</cite>: Dog-leg trust-region</li>
<li><cite>’slsqp’</cite>: Sequential Linear Squares Programming</li>
<li><cite>’emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</li>
</ul>
<p>In most cases, these methods wrap and use the method with the
same name from <cite>scipy.optimize</cite>, or use
<cite>scipy.optimize.minimize</cite> with the same <cite>method</cite> argument.
Thus ‘<cite>leastsq</cite>’ will use <cite>scipy.optimize.leastsq</cite>, while
‘<cite>powell</cite>’ will use <cite>scipy.optimize.minimizer(…,
method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</li>
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Parameters of the model to use as starting values.</li>
<li><strong>**kws</strong> (<em>optional</em>) – Additional arguments are passed to the underlying minimization
method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.leastsq">
<code class="descclassname">Minimizer.</code><code class="descname">leastsq</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.leastsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Levenberg-Marquardt minimization to perform a fit.</p>
<p>It assumes that the input Parameters have been initialized, and
a function to minimize has been properly set up.
When possible, this calculates the estimated uncertainties and
variable correlations from the covariance matrix.</p>
<p>This method calls <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.
By default, numerical derivatives are used, and the following
arguments are set:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="17%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference internal" href="#lmfit.minimizer.Minimizer.leastsq" title="lmfit.minimizer.Minimizer.leastsq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code></a>
arg</th>
<th class="head">Default Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>xtol</td>
<td>1.e-7</td>
<td>Relative error in the approximate solution</td>
</tr>
<tr class="row-odd"><td>ftol</td>
<td>1.e-7</td>
<td>Relative error in the desired sum of squares</td>
</tr>
<tr class="row-even"><td>maxfev</td>
<td>2000*(nvar+1)</td>
<td>Maximum number of function calls (nvar= # of variables)</td>
</tr>
<tr class="row-odd"><td>Dfun</td>
<td>None</td>
<td>Function to call for Jacobian calculation</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Parameters to use as starting point.</li>
<li><strong>**kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Minimizer options to pass to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leastsq</a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the optimized parameter
and several goodness-of-fit statistics.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.least_squares">
<code class="descclassname">Minimizer.</code><code class="descname">least_squares</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.least_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Least-squares minimization using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">scipy.optimize.least_squares</a>.</p>
<p>This method wraps <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">scipy.optimize.least_squares</a>, which has inbuilt
support for bounds and robust loss functions. By default it uses the
Trust Region Reflective algorithm with a linear loss function (i.e.,
the standard least-squares problem).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Parameters to use as starting point.</li>
<li><strong>**kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Minimizer options to pass to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">scipy.optimize.least_squares</a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.scalar_minimize">
<code class="descclassname">Minimizer.</code><code class="descname">scalar_minimize</code><span class="sig-paren">(</span><em>method='Nelder-Mead'</em>, <em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.scalar_minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Scalar minimization using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>.</p>
<p>Perform fit with any of the scalar minimization algorithms supported by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>. Default argument values are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="18%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference internal" href="#lmfit.minimizer.Minimizer.scalar_minimize" title="lmfit.minimizer.Minimizer.scalar_minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scalar_minimize()</span></code></a>
arg</th>
<th class="head">Default Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>method</td>
<td><code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code></td>
<td>fitting method</td>
</tr>
<tr class="row-odd"><td>tol</td>
<td>1.e-7</td>
<td>fitting and parameter tolerance</td>
</tr>
<tr class="row-even"><td>hess</td>
<td>None</td>
<td>Hessian of objective function</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Name of the fitting method to use. One of:</p>
<ul>
<li>’Nelder-Mead’ (default)</li>
<li>’L-BFGS-B’</li>
<li>’Powell’</li>
<li>’CG’</li>
<li>’Newton-CG’</li>
<li>’COBYLA’</li>
<li>’BFGS’</li>
<li>’TNC’</li>
<li>’trust-ncg’</li>
<li>’trust-exact’ (SciPy &gt;= 1.0)</li>
<li>’trust-krylov’ (SciPy &gt;= 1.0)</li>
<li>’trust-constr’ (SciPy &gt;= 1.1)</li>
<li>’dogleg’</li>
<li>’SLSQP’</li>
<li>’differential_evolution’</li>
</ul>
</li>
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Parameters to use as starting point.</li>
<li><strong>**kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Minimizer options pass to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p class="rubric">Notes</p>
<p>If the objective function returns a NumPy array instead
of the expected scalar, the sum of squares of the array
will be used.</p>
<p>Note that bounds and constraints can be set on Parameters
for any of these methods, so are not supported separately
for those designed to use bounds. However, if you use the
differential_evolution method you must specify finite
(min, max) for each varying Parameter.</p>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.prepare_fit">
<code class="descclassname">Minimizer.</code><code class="descname">prepare_fit</code><span class="sig-paren">(</span><em>params=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.prepare_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare parameters for fitting.</p>
<p>Prepares and initializes model and Parameters for subsequent
fitting. This routine prepares the conversion of <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>
into fit variables, organizes parameter bounds, and parses, “compiles”
and checks constrain expressions.   The method also creates and returns
a new instance of a <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> object that contains the
copy of the Parameters that will actually be varied in the fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Contains the Parameters for the model; if None, then the
Parameters used to initialize the Minimizer object are used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method is called directly by the fitting methods, and it is
generally not necessary to call this function explicitly.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.brute">
<code class="descclassname">Minimizer.</code><code class="descname">brute</code><span class="sig-paren">(</span><em>params=None</em>, <em>Ns=20</em>, <em>keep=50</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.brute" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>brute</cite> method to find the global minimum of a function.</p>
<p>The following parameters are passed to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html">scipy.optimize.brute</a>
and cannot be changed:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="11%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference internal" href="#lmfit.minimizer.Minimizer.brute" title="lmfit.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> arg</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>full_output</td>
<td>1</td>
<td>Return the evaluation grid and
the objective function’s values on it.</td>
</tr>
<tr class="row-odd"><td>finish</td>
<td>None</td>
<td>No “polishing” function is to be used
after the grid search.</td>
</tr>
<tr class="row-even"><td>disp</td>
<td>False</td>
<td>Do not print convergence messages
(when finish is not None).</td>
</tr>
</tbody>
</table>
<p>It assumes that the input Parameters have been initialized, and a
function to minimize has been properly set up.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</li>
<li><strong>Ns</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of grid points along the axes, if not otherwise specified
(see Notes).</li>
<li><strong>keep</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of best candidates from the brute force method that are
stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">candidates</span></code> attribute. If ‘all’, then all grid
points from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html">scipy.optimize.brute</a> are stored as candidates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the parameters from the brute force method.
The return values (<cite>x0</cite>, <cite>fval</cite>, <cite>grid</cite>, <cite>Jout</cite>) from
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html">scipy.optimize.brute</a> are stored as <cite>brute_&lt;parname&gt;</cite> attributes.
The <cite>MinimizerResult</cite> also contains the <cite>candidates</cite> attribute and
<cite>show_candidates()</cite> method. The <cite>candidates</cite> attribute contains the
parameters and chisqr from the brute force method as a namedtuple,
(‘Candidate’, [‘params’, ‘score’]), sorted on the (lowest) chisqr
value. To access the values for a particular candidate one can use
<cite>result.candidate[#].params</cite> or <cite>result.candidate[#].score</cite>, where
a lower # represents a better candidate. The <cite>show_candidates(#)</cite>
uses the <code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code> method to show a specific candidate-#
or all candidates when no number is specified.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.6.</span></p>
</div>
<p class="rubric">Notes</p>
<p>The <a class="reference internal" href="#lmfit.minimizer.Minimizer.brute" title="lmfit.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method evalutes the function at each point of a
multidimensional grid of points. The grid points are generated from the
parameter ranges using <cite>Ns</cite> and (optional) <cite>brute_step</cite>.
The implementation in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html">scipy.optimize.brute</a> requires finite bounds
and the <cite>range</cite> is specified as a two-tuple <cite>(min, max)</cite> or slice-object
<cite>(min, max, brute_step)</cite>. A slice-object is used directly, whereas a
two-tuple is converted to a slice object that interpolates <cite>Ns</cite> points
from <cite>min</cite> to <cite>max</cite>, inclusive.</p>
<p>In addition, the <a class="reference internal" href="#lmfit.minimizer.Minimizer.brute" title="lmfit.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method in lmfit, handles three other
scenarios given below with their respective slice-object:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>lower bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">min</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt>
<dd>range = (<cite>min</cite>, <cite>min</cite> + <cite>Ns</cite> * <cite>brute_step</cite>, <cite>brute_step</cite>).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>upper bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">max</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt>
<dd>range = (<cite>max</cite> - <cite>Ns</cite> * <cite>brute_step</cite>, <cite>max</cite>, <cite>brute_step</cite>).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>numerical value (<code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt>
<dd>range = (<cite>value</cite> - (<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>value</cite> +
(<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>brute_step</cite>).</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd></dl>

<p>For more information, check the examples in <code class="docutils literal notranslate"><span class="pre">examples/lmfit_brute_example.ipynb</span></code>.</p>
<dl class="method">
<dt id="lmfit.minimizer.Minimizer.basinhopping">
<code class="descclassname">Minimizer.</code><code class="descname">basinhopping</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.basinhopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>basinhopping</cite> algorithm to find the global minimum of a function.</p>
<p>This method calls <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.basinhopping.html">scipy.optimize.basinhopping</a> using the default
arguments. The default minimizer is <cite>BFGS</cite>, but since lmfit supports
parameter bounds for all minimizers, the user can choose any of the
solvers present in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> object, optional) – Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Object containing the optimization results from the basinhopping
algorithm.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.10.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.ampgo">
<code class="descclassname">Minimizer.</code><code class="descname">ampgo</code><span class="sig-paren">(</span><em>params=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.ampgo" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the global minimum of a multivariate function using AMPGO.</p>
<p>AMPGO stands for ‘Adaptive Memory Programming for Global Optimization’
and is an efficient algorithm to find the global minimum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</li>
<li><strong>**kws</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Minimizer options to pass to the ampgo algorithm, the options are
listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>local: str (default is &#39;L-BFGS-B&#39;)
    Name of the local minimization method. Valid options are:
    - &#39;L-BFGS-B&#39;
    - &#39;Nelder-Mead&#39;
    - &#39;Powell&#39;
    - &#39;TNC&#39;
    - &#39;SLSQP&#39;
local_opts: dict (default is None)
    Options to pass to the local minimizer.
maxfunevals: int (default is None)
    Maximum number of function evaluations. If None, the optimization will stop
    after `totaliter` number of iterations.
totaliter: int (default is 20)
    Maximum number of global iterations.
maxiter: int (default is 5)
    Maximum number of `Tabu Tunneling` iterations during each global iteration.
glbtol: float (default is 1e-5)
    Tolerance whether or not to accept a solution after a tunneling phase.
eps1: float (default is 0.02)
    Constant used to define an aspiration value for the objective function during
    the Tunneling phase.
eps2: float (default is 0.1)
    Perturbation factor used to move away from the latest local minimum at the
    start of a Tunneling phase.
tabulistsize: int (default is 5)
    Size of the (circular) tabu search list.
tabustrategy: str (default is &#39;farthest&#39;)
    Strategy to use when the size of the tabu list exceeds `tabulistsize`. It
    can be &#39;oldest&#39; to drop the oldest point from the tabu list or &#39;farthest&#39;
    to drop the element farthest from the last local minimum found.
disp: bool (default is False)
    Set to True to print convergence messages.
</pre></div>
</div>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Object containing the parameters from the ampgo method, with fit
parameters, statistics and such. The return values (<cite>x0</cite>, <cite>fval</cite>,
<cite>eval</cite>, <cite>msg</cite>, <cite>tunnel</cite>) are stored as <cite>ampgo_&lt;parname&gt;</cite> attributes.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.10.</span></p>
</div>
<p class="rubric">Notes</p>
<p>The Python implementation was written by Andrea Gavana in 2014
(<a class="reference external" href="http://infinity77.net/global_optimization/index.html">http://infinity77.net/global_optimization/index.html</a>).</p>
<p>The details of the AMPGO algorithm are described in the paper
“Adaptive Memory Programming for Constrained Global Optimization”
located here:</p>
<p><a class="reference external" href="http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf">http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf</a></p>
</dd></dl>

<dl class="method">
<dt id="lmfit.minimizer.Minimizer.emcee">
<code class="descclassname">Minimizer.</code><code class="descname">emcee</code><span class="sig-paren">(</span><em>params=None</em>, <em>steps=1000</em>, <em>nwalkers=100</em>, <em>burn=0</em>, <em>thin=1</em>, <em>ntemps=1</em>, <em>pos=None</em>, <em>reuse_sampler=False</em>, <em>workers=1</em>, <em>float_behavior='posterior'</em>, <em>is_weighted=True</em>, <em>seed=None</em>, <em>progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.minimizer.Minimizer.emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian sampling of the posterior distribution using <cite>emcee</cite>.</p>
<p>Bayesian sampling of the posterior distribution for the parameters
using the <cite>emcee</cite> Markov Chain Monte Carlo package. The method assumes
that the prior is Uniform. You need to have <cite>emcee</cite> installed to use
this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, optional) – Parameters to use as starting point. If this is not specified
then the Parameters used to initialize the Minimizer object are
used.</li>
<li><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – How many samples you would like to draw from the posterior
distribution for each of the walkers?</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – Should be set so <span class="math notranslate nohighlight">\(nwalkers &gt;&gt; nvarys\)</span>, where <cite>nvarys</cite> are
the number of parameters being varied during the fit.
“Walkers are the members of the ensemble. They are almost like
separate Metropolis-Hastings chains but, of course, the proposal
distribution for a given walker depends on the positions of all
the other walkers in the ensemble.” - from the <cite>emcee</cite> webpage.</li>
<li><strong>burn</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – Discard this many samples from the start of the sampling regime.</li>
<li><strong>thin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – Only accept 1 in every <cite>thin</cite> samples.</li>
<li><strong>ntemps</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – If <cite>ntemps &gt; 1</cite> perform a Parallel Tempering.</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Specify the initial positions for the sampler.  If <cite>ntemps == 1</cite>
then <cite>pos.shape</cite> should be <cite>(nwalkers, nvarys)</cite>. Otherwise,
<cite>(ntemps, nwalkers, nvarys)</cite>. You can also initialise using a
previous chain that had the same <cite>ntemps</cite>, <cite>nwalkers</cite> and
<cite>nvarys</cite>. Note that <cite>nvarys</cite> may be one larger than you expect it
to be if your <cite>userfcn</cite> returns an array and <cite>is_weighted is
False</cite>.</li>
<li><strong>reuse_sampler</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If you have already run <cite>emcee</cite> on a given <cite>Minimizer</cite> object then
it possesses an internal <code class="docutils literal notranslate"><span class="pre">sampler</span></code> attribute. You can continue to
draw from the same sampler (retaining the chain history) if you set
this option to True. Otherwise a new sampler is created. The
<cite>nwalkers</cite>, <cite>ntemps</cite>, <cite>pos</cite>, and <cite>params</cite> keywords are ignored with
this option.
<strong>Important</strong>: the Parameters used to create the sampler must not
change in-between calls to <cite>emcee</cite>. Alteration of Parameters
would include changed <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">vary</span></code> and <code class="docutils literal notranslate"><span class="pre">expr</span></code>
attributes. This may happen, for example, if you use an altered
Parameters object and call the <cite>minimize</cite> method in-between calls
to <cite>emcee</cite>.</li>
<li><strong>workers</strong> (<em>Pool-like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) – For parallelization of sampling.  It can be any Pool-like object
with a map method that follows the same calling sequence as the
built-in <cite>map</cite> function. If int is given as the argument, then a
multiprocessing-based pool is spawned internally with the
corresponding number of parallel processes. ‘mpi4py’-based
parallelization and ‘joblib’-based parallelization pools can also
be used here. <strong>Note</strong>: because of multiprocessing overhead it may
only be worth parallelising if the objective function is expensive
to calculate, or if there are a large number of objective
evaluations per step (<cite>ntemps * nwalkers * nvarys</cite>).</li>
<li><strong>float_behavior</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Specifies meaning of the objective function output if it returns a
float. One of:</p>
<ul>
<li>’posterior’ - objective function returns a log-posterior
probability</li>
<li>’chi2’ - objective function returns <span class="math notranslate nohighlight">\(\chi^2\)</span></li>
</ul>
<p>See Notes for further details.</p>
</li>
<li><strong>is_weighted</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Has your objective function been weighted by measurement
uncertainties? If <cite>is_weighted is True</cite> then your objective
function is assumed to return residuals that have been divided by
the true measurement uncertainty <cite>(data - model) / sigma</cite>. If
<cite>is_weighted is False</cite> then the objective function is assumed to
return unweighted residuals, <cite>data - model</cite>. In this case <cite>emcee</cite>
will employ a positive measurement uncertainty during the sampling.
This measurement uncertainty will be present in the output params
and output chain with the name <cite>__lnsigma</cite>. A side effect of this
is that you cannot use this parameter name yourself.
<strong>Important</strong> this parameter only has any effect if your objective
function returns an array. If your objective function returns a
float, then this parameter is ignored. See Notes for more details.</li>
<li><strong>seed</strong> (int or <cite>numpy.random.RandomState</cite>, optional) – If <cite>seed</cite> is an int, a new <cite>numpy.random.RandomState</cite> instance is
used, seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a <cite>numpy.random.RandomState</cite> instance, then
that <cite>numpy.random.RandomState</cite> instance is used.
Specify <cite>seed</cite> for repeatable minimizations.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">MinimizerResult object containing updated params, statistics,
etc. The updated params represent the median (50th percentile) of
all the samples, whilst the parameter uncertainties are half of the
difference between the 15.87 and 84.13 percentiles.
The <cite>MinimizerResult</cite> also contains the <code class="docutils literal notranslate"><span class="pre">chain</span></code>, <code class="docutils literal notranslate"><span class="pre">flatchain</span></code>
and <code class="docutils literal notranslate"><span class="pre">lnprob</span></code> attributes. The <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">flatchain</span></code>
attributes contain the samples and have the shape
<cite>(nwalkers, (steps - burn) // thin, nvarys)</cite> or
<cite>(ntemps, nwalkers, (steps - burn) // thin, nvarys)</cite>,
depending on whether Parallel tempering was used or not.
<cite>nvarys</cite> is the number of parameters that are allowed to vary.
The <code class="docutils literal notranslate"><span class="pre">flatchain</span></code> attribute is a <cite>pandas.DataFrame</cite> of the
flattened chain, <cite>chain.reshape(-1, nvarys)</cite>. To access flattened
chain values for a particular parameter use
<cite>result.flatchain[parname]</cite>. The <code class="docutils literal notranslate"><span class="pre">lnprob</span></code> attribute contains the
log probability for each sample in <code class="docutils literal notranslate"><span class="pre">chain</span></code>. The sample with the
highest probability corresponds to the maximum likelihood estimate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method samples the posterior distribution of the parameters using
Markov Chain Monte Carlo.  To do so it needs to calculate the
log-posterior probability of the model parameters, <cite>F</cite>, given the data,
<cite>D</cite>, <span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>. This ‘posterior probability’ is
calculated as:</p>
<div class="math notranslate nohighlight">
\[\ln p(F_{true} | D) \propto \ln p(D | F_{true}) + \ln p(F_{true})\]</div>
<p>where <span class="math notranslate nohighlight">\(\ln p(D | F_{true})\)</span> is the ‘log-likelihood’ and
<span class="math notranslate nohighlight">\(\ln p(F_{true})\)</span> is the ‘log-prior’. The default log-prior
encodes prior information already known about the model. This method
assumes that the log-prior probability is <cite>-numpy.inf</cite> (impossible) if
the one of the parameters is outside its limits. The log-prior probability
term is zero if all the parameters are inside their bounds (known as a
uniform prior). The log-likelihood function is given by <a class="footnote-reference" href="#id2" id="id1">[1]</a>:</p>
<div class="math notranslate nohighlight">
\[\ln p(D|F_{true}) = -\frac{1}{2}\sum_n \left[\frac{(g_n(F_{true}) - D_n)^2}{s_n^2}+\ln (2\pi s_n^2)\right]\]</div>
<p>The first summand in the square brackets represents the residual for a
given datapoint (<span class="math notranslate nohighlight">\(g\)</span> being the generative model, <span class="math notranslate nohighlight">\(D_n\)</span> the
data and <span class="math notranslate nohighlight">\(s_n\)</span> the standard deviation, or measurement
uncertainty, of the datapoint). This term represents <span class="math notranslate nohighlight">\(\chi^2\)</span>
when summed over all data points.
Ideally the objective function used to create <cite>lmfit.Minimizer</cite> should
return the log-posterior probability, <span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>.
However, since the in-built log-prior term is zero, the objective
function can also just return the log-likelihood, unless you wish to
create a non-uniform prior.</p>
<p>If a float value is returned by the objective function then this value
is assumed by default to be the log-posterior probability, i.e.
<cite>float_behavior is ‘posterior’</cite>. If your objective function returns
<span class="math notranslate nohighlight">\(\chi^2\)</span>, then you should use a value of <cite>‘chi2’</cite> for
<cite>float_behavior</cite>. <cite>emcee</cite> will then multiply your <span class="math notranslate nohighlight">\(\chi^2\)</span> value
by -0.5 to obtain the posterior probability.</p>
<p>However, the default behaviour of many objective functions is to return
a vector of (possibly weighted) residuals. Therefore, if your objective
function returns a vector, <cite>res</cite>, then the vector is assumed to contain
the residuals. If <cite>is_weighted is True</cite> then your residuals are assumed
to be correctly weighted by the standard deviation (measurement
uncertainty) of the data points (<cite>res = (data - model) / sigma</cite>) and
the log-likelihood (and log-posterior probability) is calculated as:
<cite>-0.5 * numpy.sum(res**2)</cite>.
This ignores the second summand in the square brackets. Consequently,
in order to calculate a fully correct log-posterior probability value
your objective function should return a single value. If
<cite>is_weighted is False</cite> then the data uncertainty, <cite>s_n</cite>, will be
treated as a nuisance parameter and will be marginalized out. This is
achieved by employing a strictly positive uncertainty
(homoscedasticity) for each data point, <span class="math notranslate nohighlight">\(s_n = \exp(\_\_lnsigma)\)</span>.
<cite>__lnsigma</cite> will be present in <cite>MinimizerResult.params</cite>, as well as
<cite>Minimizer.chain</cite>, <cite>nvarys</cite> will also be increased by one.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://dan.iel.fm/emcee/current/user/line/">http://dan.iel.fm/emcee/current/user/line/</a></td></tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="minimizer-emcee-calculating-the-posterior-probability-distribution-of-parameters">
<span id="label-emcee"></span><h2><a class="reference internal" href="#lmfit.minimizer.Minimizer.emcee" title="lmfit.minimizer.Minimizer.emcee"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.emcee()</span></code></a> - calculating the posterior probability distribution of parameters<a class="headerlink" href="#minimizer-emcee-calculating-the-posterior-probability-distribution-of-parameters" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#lmfit.minimizer.Minimizer.emcee" title="lmfit.minimizer.Minimizer.emcee"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.emcee()</span></code></a> can be used to obtain the posterior probability distribution of
parameters, given a set of experimental data. An example problem is a double
exponential decay. A small amount of Gaussian noise is also added in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">lmfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="_images/emcee_dbl_exp.png"><img alt="_images/emcee_dbl_exp.png" src="_images/emcee_dbl_exp.png" style="width: 50%;" /></a>
<p>Create a Parameter set for the initial guesses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">Parameters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_many</span><span class="p">((</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="mf">4.</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="mf">3.</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;t2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span>
</pre></div>
</div>
<p>Solving with <a class="reference internal" href="#lmfit.minimizer.minimize" title="lmfit.minimizer.minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> gives the Maximum Likelihood solution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span> <span class="o">=</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder&#39;</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lmfit</span><span class="o">.</span><span class="n">printfuncs</span><span class="o">.</span><span class="n">report_fit</span><span class="p">(</span><span class="n">mi</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">min_correl</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[[Variables]]</span>
<span class="go">    a1:  2.98623689 (init = 4)</span>
<span class="go">    a2: -4.33525597 (init = 4)</span>
<span class="go">    t1:  1.30993186 (init = 3)</span>
<span class="go">    t2:  11.8240752 (init = 3)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">residual</span><span class="p">(</span><span class="n">mi</span><span class="o">.</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="_images/emcee_dbl_exp2.png"><img alt="_images/emcee_dbl_exp2.png" src="_images/emcee_dbl_exp2.png" style="width: 50%;" /></a>
<p>However, this doesn’t give a probability distribution for the parameters.
Furthermore, we wish to deal with the data uncertainty. This is called
marginalisation of a nuisance parameter. <code class="docutils literal notranslate"><span class="pre">emcee</span></code> requires a function that returns
the log-posterior probability. The log-posterior probability is a sum of the
log-prior probability and log-likelihood functions. The log-prior probability is
assumed to be zero if all the parameters are within their bounds and <code class="docutils literal notranslate"><span class="pre">-np.inf</span></code>
if any of the parameters are outside their bounds.</p>
<p>If the objective function returns an array of unweighted residuals (i.e.,
<code class="docutils literal notranslate"><span class="pre">data-model</span></code>) as is the case here, you can use <code class="docutils literal notranslate"><span class="pre">is_weighted=False</span></code> as an
argument for <code class="docutils literal notranslate"><span class="pre">emcee</span></code>. In that case, <code class="docutils literal notranslate"><span class="pre">emcee</span></code> will automatically add/use the
<code class="docutils literal notranslate"><span class="pre">__lnsigma</span></code> parameter to estimate the true uncertainty in the data. To
place boundaries on this parameter one can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;__lnsigma&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="nb">min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span> <span class="nb">max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>Now we have to set up the minimizer and do the sampling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;emcee&#39;</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span> <span class="n">burn</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">thin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="go">                         params=mi.params, is_weighted=False)</span>
</pre></div>
</div>
<p>Of note, the <code class="docutils literal notranslate"><span class="pre">is_weighted</span></code> argument will be ignored if your objective function
returns a float instead of an array. See the Notes in <a class="reference internal" href="#lmfit.minimizer.Minimizer.emcee" title="lmfit.minimizer.Minimizer.emcee"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Minimizer.emcee()</span></code></a> for
more information.</p>
<p>Lets have a look at those posterior distributions for the parameters. This requires
installation of the <cite>corner</cite> package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">corner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">flatchain</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">var_names</span><span class="p">,</span> <span class="n">truths</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
<a class="reference external image-reference" href="_images/emcee_corner.png"><img alt="_images/emcee_corner.png" src="_images/emcee_corner.png" style="width: 75%;" /></a>
<p>The values reported in the <a class="reference internal" href="#lmfit.minimizer.MinimizerResult" title="lmfit.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> are the medians of the
probability distributions and a 1 <span class="math notranslate nohighlight">\(\sigma\)</span> quantile, estimated as half the
difference between the 15.8 and 84.2 percentiles. The median value is not
necessarily the same as the Maximum Likelihood Estimate. We’ll get that as well.
You can see that we recovered the right uncertainty level on the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;median of posterior probability distribution&quot;</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">report_fit</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
 <span class="n">median</span> <span class="n">of</span> <span class="n">posterior</span> <span class="n">probability</span> <span class="n">distribution</span>
 <span class="o">--------------------------------------------</span>
 <span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
     <span class="n">a1</span><span class="p">:</span>         <span class="mf">3.00096797</span> <span class="o">+/-</span> <span class="mf">0.14231292</span> <span class="p">(</span><span class="mf">4.74</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mf">2.986237</span><span class="p">)</span>
     <span class="n">a2</span><span class="p">:</span>        <span class="o">-</span><span class="mf">4.34208406</span> <span class="o">+/-</span> <span class="mf">0.12652899</span> <span class="p">(</span><span class="mf">2.91</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.335256</span><span class="p">)</span>
     <span class="n">t1</span><span class="p">:</span>         <span class="mf">1.31910309</span> <span class="o">+/-</span> <span class="mf">0.14180921</span> <span class="p">(</span><span class="mf">10.75</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mf">1.309932</span><span class="p">)</span>
     <span class="n">t2</span><span class="p">:</span>         <span class="mf">11.7812397</span> <span class="o">+/-</span> <span class="mf">0.49805858</span> <span class="p">(</span><span class="mf">4.23</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mf">11.82408</span><span class="p">)</span>
     <span class="n">__lnsigma</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.32838725</span> <span class="o">+/-</span> <span class="mf">0.04403968</span> <span class="p">(</span><span class="mf">1.89</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.302585</span><span class="p">)</span>
 <span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span> <span class="mf">0.100</span><span class="p">)</span>
     <span class="n">C</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.982</span>
     <span class="n">C</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.940</span>
     <span class="n">C</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.897</span>
     <span class="n">C</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.504</span>
     <span class="n">C</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.214</span>
     <span class="n">C</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.174</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="c1"># find the maximum likelihood solution</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">highest_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">lnprob</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">hp_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">highest_prob</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">lnprob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">mle_soln</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">chain</span><span class="p">[</span><span class="n">hp_loc</span><span class="p">]</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
 <span class="o">...</span>     <span class="n">p</span><span class="p">[</span><span class="n">par</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">mle_soln</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Maximum likelihood Estimation&quot;</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------&#39;</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
 <span class="n">Maximum</span> <span class="n">likelihood</span> <span class="n">Estimation</span>
 <span class="o">-----------------------------</span>
<span class="n">Parameters</span><span class="p">([(</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Parameter</span> <span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="mf">3.003878755004621</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">:</span><span class="n">inf</span><span class="p">]</span><span class="o">&gt;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Parameter</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.327965057455135</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">:</span><span class="n">inf</span><span class="p">]</span><span class="o">&gt;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Parameter</span> <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="mf">1.3006869431937975</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">:</span><span class="n">inf</span><span class="p">]</span><span class="o">&gt;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Parameter</span> <span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="mf">11.848423244767798</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">:</span><span class="n">inf</span><span class="p">]</span><span class="o">&gt;</span><span class="p">)])</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="c1"># Finally lets work out a 1 and 2-sigma error estimate for &#39;t1&#39;</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">quantiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">flatchain</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.28</span><span class="p">,</span> <span class="mf">15.9</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">84.2</span><span class="p">,</span> <span class="mf">97.7</span><span class="p">])</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1 sigma spread&quot;</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">quantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2 sigma spread&quot;</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">quantiles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">quantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
 <span class="mi">1</span> <span class="n">sigma</span> <span class="n">spread</span> <span class="mf">0.14235120263891188</span>
 <span class="mi">2</span> <span class="n">sigma</span> <span class="n">spread</span> <span class="mf">0.2873717185860183</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-and-printing-fit-reports">
<h2>Getting and Printing Fit Reports<a class="headerlink" href="#getting-and-printing-fit-reports" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="lmfit.printfuncs.fit_report">
<code class="descname">fit_report</code><span class="sig-paren">(</span><em>inpars</em>, <em>modelpars=None</em>, <em>show_correl=True</em>, <em>min_correl=0.1</em>, <em>sort_pars=False</em><span class="sig-paren">)</span><a class="headerlink" href="#lmfit.printfuncs.fit_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report of the fitting results.</p>
<p>The report contains the best-fit values for the parameters and their
uncertainties and correlations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inpars</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><em>Parameters</em></a>) – Input Parameters from fit or MinimizerResult returned from a fit.</li>
<li><strong>modelpars</strong> (<a class="reference internal" href="parameters.html#lmfit.parameter.Parameters" title="lmfit.parameter.Parameters"><em>Parameters</em></a><em>, </em><em>optional</em>) – Known Model Parameters.</li>
<li><strong>show_correl</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to show list of sorted correlations (default is True).</li>
<li><strong>min_correl</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) – Smallest correlation in absolute value to show (default is 0.1).</li>
<li><strong>sort_pars</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><em>callable</em><em>, </em><em>optional</em>) – Whether to show parameter names sorted in alphanumerical order. If
False (default), then the parameters will be listed in the order they
were added to the Parameters dictionary. If callable, then this (one
argument) function is used to extract a comparison key from each
list element.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Multi-line text of fit report.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>An example using this to write out a fit report would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># &lt;examples/doc_fitting_withreport.py&gt;</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">sin</span>

<span class="kn">from</span> <span class="nn">lmfit</span> <span class="k">import</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">fit_report</span><span class="p">,</span> <span class="n">minimize</span>

<span class="n">p_true</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">p_true</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">14.0</span><span class="p">)</span>
<span class="n">p_true</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">5.46</span><span class="p">)</span>
<span class="n">p_true</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.123</span><span class="p">)</span>
<span class="n">p_true</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;decay&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.032</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">valuesdict</span><span class="p">()</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">]</span>
    <span class="n">per</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span>
    <span class="n">decay</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;decay&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">-</span> <span class="n">sign</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">shift</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="n">per</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">decay</span><span class="o">*</span><span class="n">decay</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span>
    <span class="k">return</span> <span class="n">model</span> <span class="o">-</span> <span class="n">data</span>


<span class="n">n</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">250.0</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.7215</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">residual</span><span class="p">(</span><span class="n">p_true</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>

<span class="n">fit_params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">fit_params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">13.0</span><span class="p">)</span>
<span class="n">fit_params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fit_params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">fit_params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;decay&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">fit_params</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,),</span> <span class="n">kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_report</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
<span class="c1"># &lt;end of examples/doc_fitting_withreport.py&gt;</span>
</pre></div>
</div>
<p>which would write out:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">Fit</span> <span class="n">Statistics</span><span class="p">]]</span>
    <span class="c1"># fitting method   = leastsq</span>
    <span class="c1"># function evals   = 83</span>
    <span class="c1"># data points      = 1001</span>
    <span class="c1"># variables        = 4</span>
    <span class="n">chi</span><span class="o">-</span><span class="n">square</span>         <span class="o">=</span> <span class="mf">498.811759</span>
    <span class="n">reduced</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="o">=</span> <span class="mf">0.50031270</span>
    <span class="n">Akaike</span> <span class="n">info</span> <span class="n">crit</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">689.222517</span>
    <span class="n">Bayesian</span> <span class="n">info</span> <span class="n">crit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">669.587497</span>
<span class="p">[[</span><span class="n">Variables</span><span class="p">]]</span>
    <span class="n">amp</span><span class="p">:</span>     <span class="mf">13.9121945</span> <span class="o">+/-</span> <span class="mf">0.14120288</span> <span class="p">(</span><span class="mf">1.01</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="n">period</span><span class="p">:</span>  <span class="mf">5.48507045</span> <span class="o">+/-</span> <span class="mf">0.02666492</span> <span class="p">(</span><span class="mf">0.49</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">shift</span><span class="p">:</span>   <span class="mf">0.16203677</span> <span class="o">+/-</span> <span class="mf">0.01405661</span> <span class="p">(</span><span class="mf">8.67</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">decay</span><span class="p">:</span>   <span class="mf">0.03264538</span> <span class="o">+/-</span> <span class="mf">3.8014e-04</span> <span class="p">(</span><span class="mf">1.16</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="n">init</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="p">[[</span><span class="n">Correlations</span><span class="p">]]</span> <span class="p">(</span><span class="n">unreported</span> <span class="n">correlations</span> <span class="n">are</span> <span class="o">&lt;</span> <span class="mf">0.100</span><span class="p">)</span>
    <span class="n">C</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.797</span>
    <span class="n">C</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">0.582</span>
    <span class="n">C</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>    <span class="o">=</span> <span class="o">-</span><span class="mf">0.297</span>
    <span class="n">C</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.243</span>
    <span class="n">C</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.182</span>
    <span class="n">C</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.150</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="model.html" title="Modeling Data and Curve Fitting"
             >next</a> |</li>
        <li class="right" >
          <a href="parameters.html" title="Parameter and Parameters"
             >previous</a> |</li>
   <li>[<a href="intro.html">intro</a>|</li>
   <li><a href="parameters.html">parameters</a>|</li>
   <li><a href="#"> minimize</a>|</li>
   <li><a href="model.html"> model</a>|</li>
   <li><a href="builtin_models.html"> built-in models</a>|</li>
   <li><a href="confidence.html">confidence intervals</a>|</li>
   <li><a href="bounds.html">bounds</a>|</li>
   <li><a href="constraints.html">constraints</a>]</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Matthew Newville, The University of Chicago, Till Stensitzki, Freie Universitat Berlin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>